<html>
<head>
<title>MainController.java</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.ln { color: #999999; font-weight: normal; font-style: normal; }
.s0 { color: rgb(0,0,128); font-weight: bold; }
.s1 { color: rgb(0,0,0); }
.s2 { color: rgb(128,128,128); font-style: italic; }
.s3 { color: rgb(128,128,128); font-weight: bold; font-style: italic; }
.s4 { color: rgb(0,0,255); }
.s5 { color: rgb(0,128,0); font-weight: bold; }
</style>
</head>
<BODY BGCOLOR="#ffffff">
<TABLE CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#c0c0c0" >
<TR><TD><CENTER>
<FONT FACE="Arial, Helvetica" COLOR="#000000">
MainController.java</FONT>
</center></TD></TR></TABLE>
<pre>
<span class="s0">package </span><span class="s1">controller; 
 
</span><span class="s0">import </span><span class="s1">com.lynden.gmapsfx.GoogleMapView; 
</span><span class="s0">import </span><span class="s1">com.lynden.gmapsfx.MapComponentInitializedListener; 
</span><span class="s0">import </span><span class="s1">fxapp.Main; 
 
</span><span class="s0">import </span><span class="s1">javafx.collections.ObservableList; 
</span><span class="s0">import </span><span class="s1">javafx.fxml.FXML; 
 
</span><span class="s0">import </span><span class="s1">javafx.scene.control.Button; 
</span><span class="s0">import </span><span class="s1">javafx.scene.control.TextField; 
</span><span class="s0">import </span><span class="s1">javafx.scene.control.ComboBox; 
</span><span class="s0">import </span><span class="s1">javafx.scene.control.Tab; 
</span><span class="s0">import </span><span class="s1">javafx.scene.control.TabPane; 
</span><span class="s0">import </span><span class="s1">javafx.scene.control.Label; 
</span><span class="s0">import </span><span class="s1">javafx.scene.control.ListView; 
</span><span class="s0">import </span><span class="s1">javafx.scene.control.TextFormatter; 
</span><span class="s0">import </span><span class="s1">javafx.stage.Stage; 
</span><span class="s0">import </span><span class="s1">model.Users.Account; 
</span><span class="s0">import </span><span class="s1">model.report.OverallCondition; 
</span><span class="s0">import </span><span class="s1">model.report.Report; 
</span><span class="s0">import </span><span class="s1">model.report.WaterCondition; 
</span><span class="s0">import </span><span class="s1">model.report.WaterType; 
 
</span><span class="s0">import </span><span class="s1">java.text.DecimalFormat; 
</span><span class="s0">import </span><span class="s1">java.text.ParsePosition; 
</span><span class="s0">import </span><span class="s1">java.util.ArrayList; 
</span><span class="s0">import </span><span class="s1">java.util.Arrays; 
</span><span class="s0">import </span><span class="s1">java.util.List; 
 
</span><span class="s2">/** 
 * The controller for the root/main window 
 * 
 */</span><span class="s1"> 
</span><span class="s0">public class </span><span class="s1">MainController { 
 
    @FXML 
    </span><span class="s0">private </span><span class="s1">Button Logout; 
    @FXML 
    </span><span class="s0">private </span><span class="s1">TextField lastnametextbox; 
    @FXML 
    </span><span class="s0">private  </span><span class="s1">TextField firstnametextbox; 
    @FXML 
    </span><span class="s0">private </span><span class="s1">TextField streetaddresstextbox; 
    @FXML 
    </span><span class="s0">private </span><span class="s1">TextField citytextbox; 
    @FXML 
    </span><span class="s0">private </span><span class="s1">TextField statetextbox; 
    @FXML 
    </span><span class="s0">private </span><span class="s1">TextField countrytextbox; 
    @FXML 
    </span><span class="s0">private </span><span class="s1">TextField aptnumtextbox; 
    @FXML 
    </span><span class="s0">private </span><span class="s1">TextField zipcodetextbox; 
    @FXML 
    </span><span class="s0">private </span><span class="s1">TextField emailtextbox; 
    @FXML 
    </span><span class="s0">private </span><span class="s1">ComboBox&lt;String&gt; salutationcombobox; 
    @FXML 
    </span><span class="s0">private </span><span class="s1">Button salutationedit; 
    @FXML 
    </span><span class="s0">private </span><span class="s1">Button submit; 
    @FXML 
    </span><span class="s0">private </span><span class="s1">Label currsalutation; 
    @FXML 
    </span><span class="s0">private </span><span class="s1">TextField latitude; 
    @FXML 
    </span><span class="s0">private </span><span class="s1">TextField longitude; 
    @FXML 
    </span><span class="s0">private </span><span class="s1">ComboBox&lt;WaterType&gt; sourceBox; 
    @FXML 
    </span><span class="s0">private </span><span class="s1">Button submitRepBox; 
    @FXML 
    </span><span class="s0">private </span><span class="s1">ComboBox&lt;WaterCondition&gt; conditionBox; 
    @FXML 
    </span><span class="s0">private </span><span class="s1">ListView&lt;Report&gt; reportlist; 
    @FXML 
    </span><span class="s0">private </span><span class="s1">Button viewreport; 
    @FXML 
    </span><span class="s0">private </span><span class="s1">TextField othertype; 
    @FXML 
    </span><span class="s0">private </span><span class="s1">GoogleMapView GmapsViewPane; 
    @FXML 
    </span><span class="s0">private </span><span class="s1">TabPane applicationTabs; 
    @FXML 
    </span><span class="s0">private </span><span class="s1">Tab submitTab; 
    @FXML 
    </span><span class="s0">private </span><span class="s1">Tab Purity; 
    @FXML 
    </span><span class="s0">private </span><span class="s1">TextField purityLat; 
    @FXML 
    </span><span class="s0">private </span><span class="s1">TextField purityLon; 
    @FXML 
    </span><span class="s0">private </span><span class="s1">TextField VirusPPM; 
    @FXML 
    </span><span class="s0">private </span><span class="s1">TextField ContamPPM; 
    @FXML 
    </span><span class="s0">private </span><span class="s1">ComboBox&lt;OverallCondition&gt; purityCond; 
    @FXML 
    </span><span class="s0">private </span><span class="s1">Button SubmitPurity; 
    @FXML 
    </span><span class="s0">private </span><span class="s1">Button avetoqual; 
    @FXML 
    </span><span class="s0">private </span><span class="s1">Button qualtoave; 
    @FXML 
    </span><span class="s0">private </span><span class="s1">Button hisreportTransition; 
    @FXML 
    </span><span class="s0">private </span><span class="s1">TextField searchLat; 
    @FXML 
    </span><span class="s0">private </span><span class="s1">TextField searchLon; 
    @FXML 
    </span><span class="s0">private </span><span class="s1">Button searchBut; 
 
    </span><span class="s2">/** reference back to mainApplication if needed */</span><span class="s1"> 
    </span><span class="s0">private </span><span class="s1">Main mainApp; 
 
    </span><span class="s2">/** 
     * allow for calling back to the main application code if necessary 
     * </span><span class="s3">@param </span><span class="s2">main   the reference to the FX Application instance 
     * */</span><span class="s1"> 
    </span><span class="s0">public void </span><span class="s1">setMainApp(Main main) { 
        mainApp = main; 
    } 
 
    @FXML 
    </span><span class="s0">private void </span><span class="s1">initialize() { 
        Logout.setOnAction(event -&gt; mainApp.showLogin()); 
 
        </span><span class="s2">// Delegates control of the profile view to ProfileController</span><span class="s1"> 
        setUpProfileController(); 
 
        </span><span class="s2">// Delegates control of report submission to AddReportController</span><span class="s1"> 
        setUpReportController(); 
 
        </span><span class="s2">// Delegates control of QualityReport submission to AddQualityController</span><span class="s1"> 
        setUpQualityController(); 
 
        </span><span class="s2">// Delegates control of the View Report screen to ReportListController</span><span class="s1"> 
        ReportListController reportList = 
                </span><span class="s0">new </span><span class="s1">ReportListController(reportlist, viewreport, hisreportTransition); 
 
        </span><span class="s2">// Delegates control of the Google Map to MapController</span><span class="s1"> 
        MapComponentInitializedListener map = </span><span class="s0">new </span><span class="s1">MapController(GmapsViewPane, searchLat, searchLon, searchBut); 
        GmapsViewPane.addMapInializedListener(map); 
        Account currUser = LoginScreenController.getCurrUser(); 
        setUserAccess(currUser); 
    } 
 
    </span><span class="s2">/** 
     * Close menu item event handler 
     */</span><span class="s1"> 
    @FXML 
    </span><span class="s0">private void </span><span class="s1">handleCloseMenu() { 
        System.exit(</span><span class="s4">0</span><span class="s1">); 
 
    } 
    </span><span class="s2">/** 
     * Forces only decimal numbers to be entered as values in corresponding 
     * TextField 
     */</span><span class="s1"> 
 
    </span><span class="s0">static void </span><span class="s1">restrictToNums(TextField field) { 
        DecimalFormat format = </span><span class="s0">new </span><span class="s1">DecimalFormat( </span><span class="s5">&quot;#&quot; </span><span class="s1">); 
        field.setTextFormatter( </span><span class="s0">new </span><span class="s1">TextFormatter&lt;&gt;(c -&gt; 
        { 
            </span><span class="s0">if </span><span class="s1">( c.getControlNewText().isEmpty() ) 
            { 
                </span><span class="s0">return </span><span class="s1">c; 
            } 
 
            ParsePosition parsePosition = </span><span class="s0">new </span><span class="s1">ParsePosition( </span><span class="s4">0 </span><span class="s1">); 
            Object object = format.parse( c.getControlNewText(), parsePosition ); 
 
            </span><span class="s0">if </span><span class="s1">( (object == </span><span class="s0">null</span><span class="s1">) || ((parsePosition.getIndex()) &lt; (c.getControlNewText().length()))) 
            { 
                </span><span class="s0">return null</span><span class="s1">; 
            } 
            </span><span class="s0">else</span><span class="s1"> 
            { 
                </span><span class="s0">return </span><span class="s1">c; 
            } 
        })); 
 
    } 
 
    </span><span class="s2">/** 
     * Takes a ComboBox and an ArrayList containing its elements then populates the ComboBox and sets 
     * the default value to the first entry in the list 
     * </span><span class="s3">@param </span><span class="s2">box the ComboBox being populated 
     * </span><span class="s3">@param </span><span class="s2">list the ArrayList being used to populate box 
     */</span><span class="s1"> 
    </span><span class="s0">static void </span><span class="s1">populateComboBox(ComboBox box, List list) { 
        box.setItems(javafx.collections.FXCollections.observableList(list)); 
        box.setValue(list.get(</span><span class="s4">0</span><span class="s1">)); 
    } 
 
    </span><span class="s0">private void </span><span class="s1">setUserAccess(Account user) { 
        ObservableList&lt;Tab&gt; tabs = applicationTabs.getTabs(); 
        tabs.remove(</span><span class="s4">4</span><span class="s1">); 
        </span><span class="s0">switch</span><span class="s1">(user.getAuthLevel()) { 
            </span><span class="s0">case </span><span class="s1">USER: 
                tabs.remove(</span><span class="s4">3</span><span class="s1">); 
                </span><span class="s0">break</span><span class="s1">; 
            </span><span class="s0">case </span><span class="s1">WORKER: 
                tabs.remove(</span><span class="s4">3</span><span class="s1">); 
                </span><span class="s0">break</span><span class="s1">; 
            </span><span class="s0">case </span><span class="s1">MANAGER: 
                </span><span class="s0">break</span><span class="s1">; 
            </span><span class="s0">case </span><span class="s1">ADMIN: 
                </span><span class="s0">for</span><span class="s1">(</span><span class="s0">int </span><span class="s1">i = </span><span class="s4">0</span><span class="s1">; i &lt; </span><span class="s4">3</span><span class="s1">; i++) { 
                    tabs.remove(</span><span class="s4">1</span><span class="s1">); 
                } 
                </span><span class="s0">break</span><span class="s1">; 
        } 
    } 
 
    </span><span class="s0">private void </span><span class="s1">setUpQualityController() { 
        restrictToNums(purityLat); 
        restrictToNums(purityLon); 
        restrictToNums(VirusPPM); 
        restrictToNums(ContamPPM); 
        List&lt;OverallCondition&gt; conditions = Arrays.asList(OverallCondition.values()); 
        MainController.populateComboBox(purityCond, conditions); 
        AddQualityController qualReport = </span><span class="s0">new </span><span class="s1">AddQualityController(purityLat, 
                purityLon, VirusPPM, ContamPPM, purityCond); 
        qualReport.setPurityButton(conditions, SubmitPurity); 
        qualReport.setSwitchButton(conditions, applicationTabs, submitTab, qualtoave); 
    } 
 
    </span><span class="s0">private void </span><span class="s1">setUpReportController() { 
        List&lt;WaterType&gt; source = Arrays.asList(WaterType.values()); 
        List&lt;WaterCondition&gt; condition = Arrays.asList(WaterCondition.values()); 
        populateComboBox(sourceBox, source); 
        populateComboBox(conditionBox, condition); 
        restrictToNums(latitude); 
        restrictToNums(longitude); 
        AddReportController addReport = </span><span class="s0">new </span><span class="s1">AddReportController(latitude, 
                longitude, sourceBox, conditionBox, avetoqual); 
        addReport.setReportButton(submitRepBox, othertype, source, condition); 
        addReport.switchToQual(applicationTabs, Purity, source, condition); 
    } 
 
    </span><span class="s0">private void </span><span class="s1">setUpProfileController() { 
        restrictToNums(aptnumtextbox); 
        restrictToNums(zipcodetextbox); 
        List&lt;String&gt; salutation = </span><span class="s0">new </span><span class="s1">ArrayList&lt;&gt;(); 
        salutation.add(</span><span class="s5">&quot;&quot;</span><span class="s1">); 
        salutation.add(</span><span class="s5">&quot;Mr.&quot;</span><span class="s1">); 
        salutation.add(</span><span class="s5">&quot;Ms.&quot;</span><span class="s1">); 
        salutation.add(</span><span class="s5">&quot;Mrs.&quot;</span><span class="s1">); 
        salutation.add(</span><span class="s5">&quot;Dr.&quot;</span><span class="s1">); 
        populateComboBox(salutationcombobox, salutation); 
        ProfileController profile = </span><span class="s0">new </span><span class="s1">ProfileController(lastnametextbox, firstnametextbox, streetaddresstextbox, 
                statetextbox, countrytextbox, citytextbox, aptnumtextbox, zipcodetextbox, 
                emailtextbox, salutationcombobox, salutationedit, submit, currsalutation); 
    } 
} 
</span></pre>
</body>
</html>