<html>
<head>
<title>ProfileController.java</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.ln { color: #999999; font-weight: normal; font-style: normal; }
.s0 { color: rgb(0,0,128); font-weight: bold; }
.s1 { color: rgb(0,0,0); }
.s2 { color: rgb(128,128,128); font-style: italic; }
.s3 { color: rgb(0,0,255); }
.s4 { color: rgb(0,128,0); font-weight: bold; }
.s5 { color: rgb(128,128,128); font-weight: bold; font-style: italic; }
</style>
</head>
<BODY BGCOLOR="#ffffff">
<TABLE CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#c0c0c0" >
<TR><TD><CENTER>
<FONT FACE="Arial, Helvetica" COLOR="#000000">
ProfileController.java</FONT>
</center></TD></TR></TABLE>
<pre>
<span class="s0">package </span><span class="s1">controller; 
 
</span><span class="s0">import </span><span class="s1">javafx.event.ActionEvent; 
</span><span class="s0">import </span><span class="s1">javafx.scene.control.Button; 
</span><span class="s0">import </span><span class="s1">javafx.scene.control.ComboBox; 
</span><span class="s0">import </span><span class="s1">javafx.scene.control.Label; 
</span><span class="s0">import </span><span class="s1">javafx.scene.control.TextField; 
</span><span class="s0">import </span><span class="s1">lib.password_hashing.PasswordStorage; 
</span><span class="s0">import </span><span class="s1">model.Users.Address; 
</span><span class="s0">import </span><span class="s1">model.Users.Profile; 
</span><span class="s0">import </span><span class="s1">model.registration.UserList; 
 
</span><span class="s2">/** 
 * Created by grizz on 9/27/2016. 
 * Handles User Profiles 
 */</span><span class="s1"> 
</span><span class="s0">class </span><span class="s1">ProfileController { 
 
    </span><span class="s0">private final </span><span class="s1">TextField lastnametextbox; 
    </span><span class="s0">private final </span><span class="s1">TextField firstnametextbox; 
    </span><span class="s0">private final </span><span class="s1">TextField streetaddresstextbox; 
    </span><span class="s0">private final </span><span class="s1">TextField citytextbox; 
    </span><span class="s0">private final </span><span class="s1">TextField statetextbox; 
    </span><span class="s0">private final </span><span class="s1">TextField countrytextbox; 
    </span><span class="s0">private final </span><span class="s1">TextField aptnumtextbox; 
    </span><span class="s0">private final </span><span class="s1">TextField zipcodetextbox; 
    </span><span class="s0">private final </span><span class="s1">TextField emailtextbox; 
    </span><span class="s0">private final </span><span class="s1">Profile currProfile; 
 
    </span><span class="s0">public </span><span class="s1">ProfileController(TextField lastnametextbox, TextField firstnametextbox, TextField streetaddresstextbox, 
                   TextField statetextbox, TextField countrytextbox, TextField citytextbox, TextField aptnumtextbox, 
                   TextField zipcodetextbox, TextField emailtextbox, ComboBox&lt;String&gt; salutationcombobox, 
                   Button salutationedit, Button submit, Label currsalutation) { 
        </span><span class="s0">this</span><span class="s1">.lastnametextbox = lastnametextbox; 
        </span><span class="s0">this</span><span class="s1">.firstnametextbox = firstnametextbox; 
        </span><span class="s0">this</span><span class="s1">.streetaddresstextbox = streetaddresstextbox; 
        </span><span class="s0">this</span><span class="s1">.statetextbox = statetextbox; 
        </span><span class="s0">this</span><span class="s1">.countrytextbox = countrytextbox; 
        </span><span class="s0">this</span><span class="s1">.citytextbox = citytextbox; 
        </span><span class="s0">this</span><span class="s1">.aptnumtextbox = aptnumtextbox; 
        </span><span class="s0">this</span><span class="s1">.zipcodetextbox = zipcodetextbox; 
        </span><span class="s0">this</span><span class="s1">.emailtextbox = emailtextbox; 
 
        salutationcombobox.setVisible(</span><span class="s0">false</span><span class="s1">); 
        salutationcombobox.setOnMousePressed(event -&gt; salutationcombobox.requestFocus()); 
        currProfile = </span><span class="s0">new </span><span class="s1">Profile(LoginScreenController.getCurrUser()); 
        </span><span class="s0">if </span><span class="s1">(currProfile.getTitle() != </span><span class="s0">null</span><span class="s1">) { 
            currsalutation.setText(currProfile.getTitle()); 
        } 
        submit.setVisible(</span><span class="s0">false</span><span class="s1">); 
        setAllEditable(</span><span class="s0">false</span><span class="s1">); 
        String name = currProfile.getName(); 
        firstnametextbox.setText(name.substring(</span><span class="s3">0</span><span class="s1">, name.indexOf(</span><span class="s4">&quot; &quot;</span><span class="s1">))); 
        lastnametextbox.setText(name.substring(name.indexOf(</span><span class="s4">&quot; &quot;</span><span class="s1">))); 
        emailtextbox.setText(currProfile.getEmail()); 
        </span><span class="s0">if </span><span class="s1">(currProfile.getAddress() != </span><span class="s0">null</span><span class="s1">) { 
            Address add = currProfile.getAddress(); 
            streetaddresstextbox.setText(add.getStreet()); 
            </span><span class="s0">if </span><span class="s1">(add.apartmentNumber() != -</span><span class="s3">1</span><span class="s1">) { 
                aptnumtextbox.setText(</span><span class="s4">&quot;&quot; </span><span class="s1">+ add.apartmentNumber()); 
            } 
            citytextbox.setText(add.getCity()); 
            statetextbox.setText(add.getState()); 
            countrytextbox.setText(add.getCountry()); 
            </span><span class="s0">if </span><span class="s1">(add.getZip() != -</span><span class="s3">1</span><span class="s1">) { 
                zipcodetextbox.setText(</span><span class="s4">&quot;&quot; </span><span class="s1">+ add.getZip()); 
            } 
        } 
 
        submit.setOnAction(event -&gt; { 
            submit.setVisible(</span><span class="s0">false</span><span class="s1">); 
            salutationedit.setVisible(</span><span class="s0">true</span><span class="s1">); 
            currProfile.changeTitle(salutationcombobox.getValue()); 
            currsalutation.setText(currProfile.getTitle()); 
            currsalutation.setVisible(</span><span class="s0">true</span><span class="s1">); 
            salutationcombobox.setVisible(</span><span class="s0">false</span><span class="s1">); 
            setAllEditable(</span><span class="s0">false</span><span class="s1">); 
            currProfile.changeName(firstnametextbox.getText() + </span><span class="s4">&quot; &quot; </span><span class="s1">+ lastnametextbox.getText()); 
            </span><span class="s0">int </span><span class="s1">zip; 
            </span><span class="s0">int </span><span class="s1">apt; 
            </span><span class="s0">if </span><span class="s1">(!currProfile.getEmail().equals(emailtextbox.getText())) { 
                </span><span class="s0">try </span><span class="s1">{ 
                    UserList.updateMap(currProfile.getEmail(), emailtextbox.getText()); 
                    currProfile.changeEmail(emailtextbox.getText()); 
                } </span><span class="s0">catch </span><span class="s1">(PasswordStorage.CannotPerformOperationException e) { 
                    </span><span class="s0">throw new </span><span class="s1">RuntimeException(e); 
                } 
            } 
            Address add = currProfile.getAddress(); 
            </span><span class="s0">if </span><span class="s1">(add == </span><span class="s0">null</span><span class="s1">) { 
                </span><span class="s0">if </span><span class="s1">(</span><span class="s4">&quot;&quot;</span><span class="s1">.equals(zipcodetextbox.getText())) { 
                    zip = -</span><span class="s3">1</span><span class="s1">; 
                } </span><span class="s0">else </span><span class="s1">{ 
                    zip = Integer.valueOf(zipcodetextbox.getText()); 
                } 
                </span><span class="s0">if </span><span class="s1">(</span><span class="s4">&quot;&quot;</span><span class="s1">.equals(aptnumtextbox.getText())) { 
                    apt = -</span><span class="s3">1</span><span class="s1">; 
                } </span><span class="s0">else </span><span class="s1">{ 
                    apt = Integer.valueOf(aptnumtextbox.getText()); 
                } 
                add = </span><span class="s0">new </span><span class="s1">Address(streetaddresstextbox.getText(), apt, 
                        citytextbox.getText(), statetextbox.getText(), zip, countrytextbox.getText()); 
            } </span><span class="s0">else </span><span class="s1">{ 
                add.setStreet(streetaddresstextbox.getText()); 
                add.setCity(citytextbox.getText()); 
                add.setState(statetextbox.getText()); 
                add.setCountry(countrytextbox.getText()); 
                </span><span class="s0">if </span><span class="s1">(</span><span class="s4">&quot;&quot;</span><span class="s1">.equals(zipcodetextbox.getText())) { 
                    add.setZip(-</span><span class="s3">1</span><span class="s1">); 
                } </span><span class="s0">else </span><span class="s1">{ 
                    add.setZip(Integer.valueOf(zipcodetextbox.getText())); 
                } 
                </span><span class="s0">if </span><span class="s1">(</span><span class="s4">&quot;&quot;</span><span class="s1">.equals(aptnumtextbox.getText())) { 
                    add.setApartmentNum(-</span><span class="s3">1</span><span class="s1">); 
                } </span><span class="s0">else </span><span class="s1">{ 
                    add.setApartmentNum(Integer.valueOf(aptnumtextbox.getText())); 
                } 
            } 
            currProfile.changeAddress(add); 
        }); 
 
        salutationedit.setOnAction((ActionEvent) -&gt; { 
            setAllEditable(</span><span class="s0">true</span><span class="s1">); 
            salutationedit.setVisible(</span><span class="s0">false</span><span class="s1">); 
            submit.setVisible(</span><span class="s0">true</span><span class="s1">); 
            salutationcombobox.setVisible(</span><span class="s0">true</span><span class="s1">); 
            salutationcombobox.setValue(currProfile.getTitle()); 
            currsalutation.setVisible(</span><span class="s0">false</span><span class="s1">); 
        }); 
    } 
    </span><span class="s2">/** 
     * Sets all texts fields as either editable or non-editable 
     * </span><span class="s5">@param </span><span class="s2">value editable or non-editable 
     */</span><span class="s1"> 
    </span><span class="s0">private void </span><span class="s1">setAllEditable(</span><span class="s0">boolean </span><span class="s1">value) { 
        lastnametextbox.setEditable(value); 
        firstnametextbox.setEditable(value); 
        emailtextbox.setEditable(value); 
        streetaddresstextbox.setEditable(value); 
        citytextbox.setEditable(value); 
        statetextbox.setEditable(value); 
        countrytextbox.setEditable(value); 
        aptnumtextbox.setEditable(value); 
        zipcodetextbox.setEditable(value); 
    } 
} 
</span></pre>
</body>
</html>