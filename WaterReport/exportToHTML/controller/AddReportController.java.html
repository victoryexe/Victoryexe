<html>
<head>
<title>AddReportController.java</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.ln { color: #999999; font-weight: normal; font-style: normal; }
.s0 { color: rgb(0,0,128); font-weight: bold; }
.s1 { color: rgb(0,0,0); }
.s2 { color: rgb(128,128,128); font-style: italic; }
.s3 { color: rgb(128,128,128); font-weight: bold; font-style: italic; }
.s4 { color: rgb(0,128,0); font-weight: bold; }
.s5 { color: rgb(0,0,255); }
</style>
</head>
<BODY BGCOLOR="#ffffff">
<TABLE CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#c0c0c0" >
<TR><TD><CENTER>
<FONT FACE="Arial, Helvetica" COLOR="#000000">
AddReportController.java</FONT>
</center></TD></TR></TABLE>
<pre>
<span class="s0">package </span><span class="s1">controller; 
 
</span><span class="s0">import </span><span class="s1">javafx.event.ActionEvent; 
</span><span class="s0">import </span><span class="s1">javafx.scene.control.Alert; 
</span><span class="s0">import </span><span class="s1">javafx.scene.control.Button; 
</span><span class="s0">import </span><span class="s1">javafx.scene.control.ButtonType; 
</span><span class="s0">import </span><span class="s1">javafx.scene.control.ComboBox; 
</span><span class="s0">import </span><span class="s1">javafx.scene.control.Tab; 
</span><span class="s0">import </span><span class="s1">javafx.scene.control.TabPane; 
</span><span class="s0">import </span><span class="s1">javafx.scene.control.TextField; 
</span><span class="s0">import </span><span class="s1">model.Users.Account; 
</span><span class="s0">import </span><span class="s1">model.Users.AuthLevel; 
</span><span class="s0">import </span><span class="s1">model.Users.User; 
</span><span class="s0">import </span><span class="s1">model.report.Location; 
</span><span class="s0">import </span><span class="s1">model.report.Report; 
</span><span class="s0">import </span><span class="s1">model.report.ReportsList; 
</span><span class="s0">import </span><span class="s1">model.report.WaterCondition; 
</span><span class="s0">import </span><span class="s1">model.report.WaterType; 
 
</span><span class="s0">import </span><span class="s1">java.util.List; 
 
</span><span class="s2">/** 
 * Created by grizz on 10/16/2016. 
 * Handles adding Water Reports to the system. 
 */</span><span class="s1"> 
</span><span class="s0">class </span><span class="s1">AddReportController { 
 
    </span><span class="s0">private final </span><span class="s1">TextField latitude; 
    </span><span class="s0">private final </span><span class="s1">TextField longitude; 
    </span><span class="s0">private final </span><span class="s1">Button avetoqual; 
    </span><span class="s0">private final </span><span class="s1">ComboBox&lt;WaterType&gt; sourceBox; 
    </span><span class="s0">private final </span><span class="s1">ComboBox&lt;WaterCondition&gt; conditionBox; 
 
    </span><span class="s0">private final </span><span class="s1">Account currUser; 
 
    </span><span class="s2">/** 
     * Takes in the information from the Main Controller and handles the 
     * functions of the Submit Report tab 
     * </span><span class="s3">@param </span><span class="s2">latitude TextField where user submits the latitude of water 
     *                 location 
     * </span><span class="s3">@param </span><span class="s2">longitude TextField where user submits the longitude of water 
     *                  location 
     * </span><span class="s3">@param </span><span class="s2">sourceBox ComboBox where user selects the water source 
     * </span><span class="s3">@param </span><span class="s2">conditionBox ComboBox where user selects the water condition 
     * </span><span class="s3">@param </span><span class="s2">avetoqual Button used to switch to the quality report 
     */</span><span class="s1"> 
    </span><span class="s0">public </span><span class="s1">AddReportController (TextField latitude, TextField longitude, 
                                ComboBox&lt;WaterType&gt; sourceBox, ComboBox&lt;WaterCondition&gt; conditionBox, 
                                Button avetoqual) { 
        </span><span class="s0">this</span><span class="s1">.latitude = latitude; 
        </span><span class="s0">this</span><span class="s1">.longitude = longitude; 
        </span><span class="s0">this</span><span class="s1">.avetoqual = avetoqual; 
        </span><span class="s0">this</span><span class="s1">.sourceBox = sourceBox; 
        </span><span class="s0">this</span><span class="s1">.conditionBox = conditionBox; 
        </span><span class="s2">//Initializes the water source and water condition ComboBoxes</span><span class="s1"> 
 
        currUser = LoginScreenController.getCurrUser(); 
 
 
        </span><span class="s0">if </span><span class="s1">(AuthLevel.USER == currUser.getAuthLevel()) { 
            avetoqual.setVisible(</span><span class="s0">false</span><span class="s1">); 
        } 
    } 
 
    </span><span class="s0">public void </span><span class="s1">setReportButton(Button submitRepBox, TextField other, 
                                List&lt;WaterType&gt; source, List&lt;WaterCondition&gt; condition) { 
        submitRepBox.setOnAction((ActionEvent event) -&gt; { 
            </span><span class="s2">// Checks for valid input before creating report</span><span class="s1"> 
            </span><span class="s0">if </span><span class="s1">(</span><span class="s4">&quot;&quot;</span><span class="s1">.equals(latitude.getText()) 
                    || </span><span class="s4">&quot;&quot;</span><span class="s1">.equals(longitude.getText())) { 
                Alert alert = </span><span class="s0">new </span><span class="s1">Alert(Alert.AlertType.ERROR, 
                        </span><span class="s4">&quot;Both Latitude and Longitude must be filled in.&quot;</span><span class="s1">, 
                        ButtonType.CLOSE); 
                alert.show(); 
            } </span><span class="s0">else if </span><span class="s1">(WaterType.OTHER.equals(sourceBox.getValue()) 
                    &amp;&amp; </span><span class="s4">&quot;&quot;</span><span class="s1">.equals(other.getText())) { 
                Alert alert = </span><span class="s0">new </span><span class="s1">Alert(Alert.AlertType.ERROR, 
                        </span><span class="s4">&quot;Please Specify Water Source.&quot;</span><span class="s1">, ButtonType.CLOSE); 
                alert.show(); 
            } </span><span class="s0">else if </span><span class="s1">((Math.abs(Double.valueOf(latitude.getText())) &gt; Location.VALID_LATITUDE) 
                    || (Math.abs(Double.valueOf(longitude.getText())) &gt; Location.VALID_LONGITUDE)) { 
                Alert alert = </span><span class="s0">new </span><span class="s1">Alert(Alert.AlertType.ERROR, 
                        </span><span class="s4">&quot;Invalid Latitude or Longitude, please&quot;</span><span class="s1"> 
                                + </span><span class="s4">&quot;enter a valid location.&quot;</span><span class="s1">, ButtonType.CLOSE); 
                alert.show(); 
            } </span><span class="s0">else </span><span class="s1">{ 
                </span><span class="s2">// creates report and stores in ReportList</span><span class="s1"> 
                Location loc = 
                        </span><span class="s0">new </span><span class="s1">Location(Double.parseDouble(latitude.getText()), 
                                Double.parseDouble(longitude.getText())); 
                Report report = ReportsList.makeReport( 
                        (User) currUser, loc, sourceBox.getValue(), conditionBox.getValue()); 
                </span><span class="s0">if </span><span class="s1">(WaterType.OTHER.equals(sourceBox.getValue())) { 
                    String otherText = </span><span class="s4">&quot;&quot;</span><span class="s1">; 
                    </span><span class="s0">if </span><span class="s1">(other.getText() != </span><span class="s0">null</span><span class="s1">) { 
                        otherText = other.getText(); 
                    } 
                    report.setOther(otherText); 
                } 
                latitude.setText(</span><span class="s4">&quot;&quot;</span><span class="s1">); 
                longitude.setText(</span><span class="s4">&quot;&quot;</span><span class="s1">); 
                sourceBox.setValue(source.get(</span><span class="s5">0</span><span class="s1">)); 
                conditionBox.setValue(condition.get(</span><span class="s5">0</span><span class="s1">)); 
                MapController.addMarker(loc); 
                Alert alert = </span><span class="s0">new </span><span class="s1">Alert(Alert.AlertType.INFORMATION, 
                        </span><span class="s2">//This will only ever have a problem if we</span><span class="s1"> 
                        </span><span class="s2">// have 2^32 reports and have reports with</span><span class="s1"> 
                        </span><span class="s2">// duplicate IDs</span><span class="s1"> 
                        </span><span class="s4">&quot;Report #W&quot; </span><span class="s1">+ (report != </span><span class="s0">null </span><span class="s1">? report.getReportID() : </span><span class="s5">0</span><span class="s1">) 
                                + </span><span class="s4">&quot; has been submitted.</span><span class="s0">\n</span><span class="s4">&quot; </span><span class="s1">+ 
                                </span><span class="s4">&quot;Thank you for your contribution.&quot;</span><span class="s1">, 
                        ButtonType.CLOSE); 
                alert.show(); 
                </span><span class="s2">// updates the View Reports ListView</span><span class="s1"> 
                ReportListController.updateList(); 
            } 
        }); 
    } 
    </span><span class="s0">public void </span><span class="s1">switchToQual(TabPane pane, Tab quality, List&lt;WaterType&gt; source, List&lt;WaterCondition&gt; condition) { 
        avetoqual.setOnAction((ActionEvent event) -&gt; { 
            latitude.setText(</span><span class="s4">&quot;&quot;</span><span class="s1">); 
            longitude.setText(</span><span class="s4">&quot;&quot;</span><span class="s1">); 
            sourceBox.setValue(source.get(</span><span class="s5">0</span><span class="s1">)); 
            conditionBox.setValue(condition.get(</span><span class="s5">0</span><span class="s1">)); 
            pane.getTabs().set(</span><span class="s5">2</span><span class="s1">, quality); 
            pane.getSelectionModel().select(quality); 
        }); 
    } 
} 
</span></pre>
</body>
</html>